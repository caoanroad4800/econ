%!TEX root = ../DSGEnotes.tex


  \subsubsection{雅各比方程}
  \label{sec:fourier-poisson-jacobian}
  雅各比方程族(Jacobian $\theta$ function)\index{Jacobian function \dotfill 雅各比方程}中的一种形式可以表示为
  \begin{equation}
    \label{eq:fourier-poisson-jacobian}
    \theta(x) = \sum_{n = - \infty}^{\infty}
    \exp \left( - n^{2} \pi x \right)
    = \sum_{n = - \infty}^{\infty} T_{x}(n).
  \end{equation}

利用泊松求和式\eqref{eq:fourier-poisson-summation-formula}，以及设$\Delta t = 1$，有
\begin{equation}
  \label{eq:fourier-poisson-jacobian-2}
  \theta(x) = 2 \pi \sum_{\nu = - \infty}^{\infty} \widetilde{T} \left( 2 \nu \pi \right)
  = \frac{1}{\sqrt{x}}
  \underbrace{
  \sum_{\nu = - \infty}^{\infty}
  \exp \left(
   - \frac{\pi \nu^{2}}{x}
  \right)
  }_{= \theta \left( \frac{1}{x} \right)},
\end{equation}

即雅各比方程\eqref{eq:fourier-poisson-jacobian}的函数方程(functional equation)形式
\begin{equation}
  \label{eq:fourier-poisson-jacobian-equiv}
  \begin{split}
    \theta \left( x \right) & = \frac{1}{\sqrt{x}} \theta \left( \frac{1}{x} \right),\\
    \Leftrightarrow \sum_{n = - \infty}^{\infty}
    \exp \left( - n^{2} \pi x \right) & = x^{-\frac{1}{2}} \sum_{\nu = - \infty}^{\infty} \exp \left( - \frac{\nu^{2} \pi }{x} \right).
  \end{split}
\end{equation}

% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
  \caption{雅各比方程的泊松求和}
    \begin{tabular}{|l|r|rrr}
    \toprule
          & \multicolumn{2}{c|}{LHS} & \multicolumn{2}{c|}{RHS} \\
    \midrule
    $n(\nu)$ & \multicolumn{1}{l|}{$\exp \left( -n^{2} \pi x \right)$} & \multicolumn{1}{l|}{$\sum_{n} \exp \left( -n^{2} \pi x \right)$} & \multicolumn{1}{l|}{$\exp \left( -\nu^{2} \pi / x \right)$} &
    \multicolumn{1}{l|}{$\sum_{\nu} \exp \left( -\nu^{2} \pi / x \right)$} \\
    \midrule
    \multicolumn{1}{|r|}{0} & 1.000000000 & \multicolumn{1}{r|}{1.000000000} & \multicolumn{1}{r|}{1.000000000} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{1} & 0.881911378 & \multicolumn{1}{r|}{2.763822757} & \multicolumn{1}{r|}{7.77304E-35} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{2} & 0.604922563 & \multicolumn{1}{r|}{3.973667882} & \multicolumn{1}{r|}{3.6506E-137} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{3} & 0.322718983 & \multicolumn{1}{r|}{4.619105849} & \multicolumn{1}{r|}{1.0359E-307} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{4} & 0.133905721 & \multicolumn{1}{r|}{4.886917291} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{5} & 0.043213918 & \multicolumn{1}{r|}{4.973345128} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{6} & 0.010846711 & \multicolumn{1}{r|}{4.995038549} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{7} & 0.002117495 & \multicolumn{1}{r|}{4.999273539} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{8} & 0.000321512 & \multicolumn{1}{r|}{4.999916562} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{9} & 3.79683E-05 & \multicolumn{1}{r|}{4.999992498} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{10} & 3.48734E-06 & \multicolumn{1}{r|}{4.999999473} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    \multicolumn{1}{|r|}{11} & 2.49126E-07 & \multicolumn{1}{r|}{4.999999971} & \multicolumn{1}{r|}{0} & \multicolumn{1}{r|}{5.000000000} \\
    \midrule
    x=    & 0.04  &       &       &  \\
\cmidrule{1-2}    \end{tabular}%
  \label{tab:fourier-poisson-jacobian-equiv}%

  \small{注：基于式\eqref{eq:fourier-poisson-jacobian-equiv}计算。excel表格见文件夹中data/20180306-poisson.xlsx .}
\end{table}%

为了说明为何傅里叶级数求和的形式即\eqref{eq:fourier-poisson-jacobian-equiv}RHS更适于进行数值计算，我们做了一个小实验，设$x=0.04$，$n=0,1,\ldots,11$。不难看出，LHS需要$n=11$，前后23项的求和才能达到小数点后6位的精度；而对于雅各比方程形式的傅里叶级数求和，RHS只需要$n=1$就能达到同样的精度，换句话说，由\eqref{eq:fourier-poisson-jacobian-equiv}我们有
\begin{equation*}
  \underbrace{
  \theta \left( 0.04 \right)
  }_{4.999999971, n=11}
  =
  \underbrace{
  \frac{1}{\sqrt{0.04}}
  }_{5.0}
  \underbrace{
  \theta \left( \frac{1}{0.04} \right)
  }_{1.000000000, \nu = 1}
\end{equation*}

\subsection{傅里叶分析与卷积}
\label{sec:fourier-series-convolution}
傅里叶分析的又一个重要特征是，它是以卷积(convolution)\index{convolution \dotfill 卷积}乘的形式出现的。如上文所示，由两个方程$f(t)$和$g(t)$构成的卷积，近似表示为一系列$g(\tau)$的加权和，$g(\tau)$是对$g(t)$的近似(copy)之一，对应权重$f(\tau)$，我们设这个卷积为$C(t)$
\begin{equation*}
  C(t) \equiv f \times g = \int_{-\infty}^{\infty} f(\tau) g(t - \tau) d \tau.
\end{equation*}

对$C(t)$作傅里叶变换，有
\begin{equation*}
  \begin{split}
  \widetilde{C}(\omega) & = \frac{1}{2 \pi}
  \int_{-\infty}^{\infty} C(t) \exp \left( - i \omega t \right) \, \mathrm{d} \omega  \\
  & = \frac{1}{2 \pi} \int_{-\infty}^{\infty}
  \int_{-\infty}^{\infty} f(\tau) g(t - \tau)
  \, \mathrm{d} \omega
  \exp \left( - i \omega t \right)
  \, \mathrm{d} t.
\end{split}
\end{equation*}

将上式中的$f(\tau)$和$g(t - \tau)$









\end{subappendices}
